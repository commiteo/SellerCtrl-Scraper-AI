# 🌍 حل مشكلة اللغة العربية في التصدير

## المشكلة
البيانات العربية تظهر مشوشة أو غير مقروءة في ملفات CSV عند التصدير.

## الحلول المُطبقة

### 1. إضافة BOM (Byte Order Mark)
```typescript
const BOM = '\uFEFF';
const csv = BOM + csvContent;
```

### 2. تحسين الترميز
```typescript
const blob = new Blob([csv], { 
  type: 'text/csv;charset=utf-8;' 
});
```

### 3. تنسيق البيانات العربية
```typescript
'Scraped At': item.scrapedAt ? new Date(item.scrapedAt).toLocaleString('en-US') : 'N/A'
```

## كيفية الاستخدام

### زر التصدير المحسن
- **الزر البرتقالي**: "Export CSV"
- يدعم اللغة العربية مع BOM
- ترميز محسن للغة العربية
- يدعم التاريخ العربي
- أفضل توافق مع Excel و Google Sheets

## برامج التطبيق

### Excel
1. افتح الملف المُصدّر
2. إذا ظهرت النصوص مشوشة:
   - اذهب إلى **Data** → **From Text/CSV**
   - اختر الملف
   - تأكد من **File Origin**: **UTF-8**
   - اضغط **Load**

### Google Sheets
1. اذهب إلى **File** → **Import**
2. اختر **Upload** واختر الملف
3. تأكد من **Import location**: **Replace current sheet**
4. اضغط **Import data**

### LibreOffice Calc
1. افتح الملف
2. إذا ظهرت النصوص مشوشة:
   - اذهب إلى **File** → **Open**
   - اختر الملف
   - في نافذة **Text Import**:
     - **Character set**: **Unicode (UTF-8)**
     - **Separator options**: **Comma**
   - اضغط **OK**

## التحسينات التقنية

### 1. BOM (Byte Order Mark)
```typescript
// إضافة BOM في بداية الملف
const BOM = '\uFEFF';
const finalContent = BOM + csvContent;
```

### 2. تنسيق التاريخ الإنجليزي
```typescript
// استخدام التنسيق الإنجليزي للتاريخ
new Date(item.scrapedAt).toLocaleString('en-US')
```

### 3. معالجة النصوص العربية
```typescript
// تنظيف النصوص العربية
const escapedValue = String(value).replace(/"/g, '""');
return `"${escapedValue}"`;
```

## اختبار الحل

### 1. تصدير البيانات
1. اذهب إلى صفحة **History**
2. اضغط على **Export CSV** (الزر البرتقالي)
3. سيتم تحميل ملف باسم `scraping_history_2025-01-21.csv`

### 2. فتح الملف
1. افتح الملف في Excel أو Google Sheets
2. تحقق من أن النصوص العربية تظهر بشكل صحيح
3. تحقق من التاريخ (يجب أن يظهر بالتنسيق الإنجليزي)

### 3. مقارنة النتائج
- **قبل الحل**: نصوص مشوشة مثل `ÙŠØ¯ÙŠÙƒØ§Ù„ØªØ±ÙŠØ¯Ù†Ø¬`
- **بعد الحل**: نصوص عربية واضحة مثل `بريك هوم`

## استكشاف الأخطاء

### النصوص لا تزال مشوشة؟
1. تأكد من استخدام زر **Export CSV**
2. جرب فتح الملف في برنامج مختلف
3. تحقق من إعدادات الترميز في البرنامج

### الملف لا يفتح؟
1. تأكد من أن الملف تم تحميله بالكامل
2. جرب إعادة التصدير
3. تحقق من مساحة التخزين

### التاريخ لا يظهر بالإنجليزي؟
1. تأكد من إعدادات اللغة في نظام التشغيل
2. جرب استخدام التنسيق اليدوي في Excel
3. تحقق من إعدادات المنطقة الزمنية

## ملاحظات مهمة

1. **BOM ضروري** للغة العربية في CSV
2. **Excel يحتاج إعدادات خاصة** للعربية
3. **Google Sheets يدعم العربية** بشكل أفضل
4. **LibreOffice** يحتاج إعدادات الترميز

## الدعم

إذا استمرت المشكلة:
1. جرب برنامج مختلف لفتح الملف
2. تحقق من إعدادات اللغة في نظام التشغيل
3. تأكد من أن النصوص الأصلية عربية صحيحة
4. جرب تصدير عينة صغيرة أولاً 