# ุฏููู ูุธุงู Cron Service ูููุฑุงูุจุฉ ุงูุชููุงุฆูุฉ

## ๐ฏ ุงููุฏู
ูุธุงู ูุฑุงูุจุฉ ุชููุงุฆู ูุนูู ูู ุงูุฎูููุฉ ุจุฏูู ุชุฏุฎู ุจุดุฑูุ ูุณุญุจ ุงูุฃุณุนุงุฑ ุชููุงุฆูุงู ุนูุฏูุง ูุญูู ุงูููุช ุงููุญุฏุฏ.

## ๐ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. Cron Service ุงูุชููุงุฆู
- **ูุนูู ูู ุงูุฎูููุฉ**: ุจุฏูู ุชุฏุฎู ุจุดุฑู
- **ูุญุต ูู ุฏูููุชูู**: ููุจุญุซ ุนู ููุชุฌุงุช ุฌุงูุฒุฉ ููุณุญุจ
- **ุณุญุจ ุชููุงุฆู**: ููููุชุฌุงุช ุงูุชู ูุตู ููุชูุง
- **ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช**: ุชููุงุฆูุงู ูุน ุงูุฃุณุนุงุฑ ุงูุฌุฏูุฏุฉ

### 2. ูุงุฌูุฉ ุชุญูู ูุญุณูุฉ
- **ุฒุฑ Start Cron**: ุชูุนูู ุงููุฑุงูุจุฉ ุงูุชููุงุฆูุฉ
- **ุฒุฑ Stop Cron**: ุฅููุงู ุงููุฑุงูุจุฉ ุงูุชููุงุฆูุฉ
- **ุนุฑุถ ุงูุญุงูุฉ**: ุญุงูุฉ Cron Service ูู ุงูููุช ุงููุนูู
- **ุฅุญุตุงุฆูุงุช**: ุนุฏุฏ ุงูููุชุฌุงุช ุงูุฌุงูุฒุฉ ููุณุญุจ

## ๐ง ููููุฉ ุงูุชุดุบูู

### ุงูุทุฑููุฉ 1: ุชุดุบูู Cron Service ูููุตู (ูููุตู ุจู)
```bash
# ูู terminal ูููุตู
npm run price-monitor-cron
```

### ุงูุทุฑููุฉ 2: ุชุดุบูู ูู ุฎูุงู Backend
```bash
# ุดุบู Backend
npm run backend

# ุซู ุงุฐูุจ ูููุงุฌูุฉ ูุงูุนู Cron Service
```

### ุงูุทุฑููุฉ 3: ุชุดุบูู ูู ุงููุงุฌูุฉ
1. **ุดุบู Backend**: `npm run backend`
2. **ุงุฐูุจ ูู Price Monitor**
3. **ุงููุฑ "Start Cron"**
4. **ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ**

## ๐ ููููุฉ ุงูุนูู

### ุฏูุฑุฉ ุงููุฑุงูุจุฉ ุงูุชููุงุฆูุฉ
1. **ูุญุต ูู ุฏูููุชูู**: ููุจุญุซ ุนู ููุชุฌุงุช `next_scrape <= now()`
2. **ุณุญุจ ุงูููุชุฌุงุช ุงูุฌุงูุฒุฉ**: ุชููุงุฆูุงู
3. **ุชุญุฏูุซ ุงูุฃุณุนุงุฑ**: ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. **ุญุณุงุจ ุงูุชุบูุฑุงุช**: ูู ุงูุฃุณุนุงุฑ
5. **ุฅูุดุงุก ุชูุจููุงุช**: ุฅุฐุง ุชุฌุงูุฒ ุงูุชุบูุฑ ุงูุนุชุจุฉ ุงููุญุฏุฏุฉ
6. **ุชุญุฏูุซ `next_scrape`**: ููุฏูุฑุฉ ุงูุชุงููุฉ

### ูุซุงู ุนูู ุงูุนูููุฉ
```
โฐ 4:50:00 PM - Cron ููุญุต ุงูููุชุฌุงุช
๐ ูุฌุฏ 2 ููุชุฌุงุช ุฌุงูุฒุฉ ููุณุญุจ
๐ ุณุญุจ B09LH36816 ูู Amazon Egypt
โ ุชุญุฏูุซ ุงูุณุนุฑ: $2000.00 โ $1999.99 (-$0.01)
๐ ุณุญุจ B0BZ15MXRZ ูู Amazon UAE  
โ ุชุญุฏูุซ ุงูุณุนุฑ: $34.00 โ $33.50 (-$0.50)
๐จ ุฅูุดุงุก ุชูุจูู: ุงูุฎูุงุถ 1.47% ูู B0BZ15MXRZ
โฐ 4:52:00 PM - ูุญุต ุงูุชุงูู
```

## ๐๏ธ ุงูุชุญูู ูู ุงููุธุงู

### ุฃุฒุฑุงุฑ ุงูุชุญูู
- **Start Cron**: ุชูุนูู ุงููุฑุงูุจุฉ ุงูุชููุงุฆูุฉ
- **Stop Cron**: ุฅููุงู ุงููุฑุงูุจุฉ ุงูุชููุงุฆูุฉ
- **Run Now**: ุชุดุบูู ุฏูุฑุฉ ูุฑุงูุจุฉ ููุฑูุฉ
- **Start/Stop**: ุงูุชุญูู ูู ุงููุฑุงูุจุฉ ุงููุฏููุฉ

### ูุคุดุฑุงุช ุงูุญุงูุฉ
- **ุงูููุทุฉ ุงูุฎุถุฑุงุก**: Cron Service ูุดุท
- **ุงูููุทุฉ ุงูุญูุฑุงุก**: Cron Service ูุชููู
- **"Due Now"**: ุนุฏุฏ ุงูููุชุฌุงุช ุงูุฌุงูุฒุฉ ููุณุญุจ
- **"Last updated"**: ุขุฎุฑ ุชุญุฏูุซ ููุจูุงูุงุช

## ๐ ุงูุฅุญุตุงุฆูุงุช

### ูุง ูุชู ุนุฑุถู
- **Total Products**: ุฅุฌูุงูู ุงูููุชุฌุงุช
- **Active Products**: ุงูููุชุฌุงุช ุงูููุนูุฉ
- **Due For Scraping**: ุงูููุชุฌุงุช ุงูุฌุงูุฒุฉ ููุณุญุจ
- **Unread Alerts**: ุงูุชูุจููุงุช ุบูุฑ ุงูููุฑูุกุฉ
- **Price Changes**: ุงูููุชุฌุงุช ุงูุชู ุชุบูุฑุช ุฃุณุนุงุฑูุง

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฅุฐุง ูู ูุนูู Cron Service
1. **ุชุญูู ูู ุชุดุบูู Backend**
2. **ุชุญูู ูู ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช**
3. **ุชุญูู ูู ุณุฌูุงุช Console**
4. **ุฃุนุฏ ุชุดุบูู Cron Service**

### ุฅุฐุง ูู ุชุชุญุฏุซ ุงูุฃุณุนุงุฑ
1. **ุชุญูู ูู ุญุงูุฉ Cron Service** (ูุดุท/ูุชููู)
2. **ุชุญูู ูู "Due Now"** (ูุฌุจ ุฃู ูููู > 0)
3. **ุงููุฑ "Run Now"** ูุชุดุบูู ุฏูุฑุฉ ููุฑูุฉ
4. **ุชุญูู ูู ุณุฌูุงุช Console** ููุฃุฎุทุงุก

### ุฅุฐุง ูุดู ุงูุณุญุจ
1. **ุชุญูู ูู ุตุญุฉ ASIN**
2. **ุชุญูู ูู ุงูููุทูุฉ ุงููุฎุชุงุฑุฉ**
3. **ุชุญูู ูู ุงุชุตุงู Amazon**
4. **ุชุญูู ูู ุณุฌูุงุช Console**

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช ุงููุชูุฏูุฉ

### ุชุบููุฑ ูุชุฑุฉ ุงููุญุต
ูู `backend/price_monitor_cron.cjs`:
```javascript
// ุชุบููุฑ ูู 2 ุฏูุงุฆู ุฅูู ุฃู ูุชุฑุฉ ุชุฑูุฏ
this.checkInterval = setInterval(async () => {
  if (this.isRunning) {
    await this.runMonitoringCycle();
  }
}, 5 * 60 * 1000); // 5 ุฏูุงุฆู
```

### ุชุบููุฑ ูุชุฑุฉ ุงูุชุฃุฎูุฑ ุจูู ุงูุทูุจุงุช
```javascript
// ุชุฃุฎูุฑ 3 ุซูุงู ุจูู ูู ุทูุจ
await new Promise(resolve => setTimeout(resolve, 3000));
```

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุชูุนูู Cron Service:
- โ ุงูููุชุฌุงุช "Due now" ุณุชุณุญุจ ุชููุงุฆูุงู
- โ ุงูุฃุณุนุงุฑ ุณุชุชุญุฏุซ ูู ุฏูููุชูู
- โ ุงูุชูุจููุงุช ุณุชููุดุฃ ุนูุฏ ุชุบูุฑ ุงูุฃุณุนุงุฑ
- โ "Last updated" ุณูุชุญุฏุซ ุชููุงุฆูุงู
- โ ูุง ุญุงุฌุฉ ูุชุฏุฎู ุจุดุฑู

## ๐ ููุงุญุธุงุช ูููุฉ

1. **Cron Service ูุณุชูู**: ูุนูู ุญุชู ูู ุฃุบููุช ุงููุชุตูุญ
2. **ูุชุฑุฉ ุงููุญุต**: ูู ุฏูููุชูู (ูุงุจูุฉ ููุชุนุฏูู)
3. **ุงูููุชุฌุงุช ุงููุดุทุฉ ููุท**: ูุชู ูุฑุงูุจุฉ ุงูููุชุฌุงุช ุงูููุนูุฉ ููุท
4. **ุณุฌูุงุช ููุตูุฉ**: ูู Console ููุชุตุญูุญ
5. **ุฅููุงู ุขูู**: ุนูุฏ ุฅููุงู Cron Service

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

```bash
# 1. ุดุบู Backend
npm run backend

# 2. ูู terminal ูููุตูุ ุดุบู Cron Service
npm run price-monitor-cron

# 3. ุงุฐูุจ ูููุงุฌูุฉ ูุชุฃูุฏ ูู ุชูุนูู Cron Service
```

ุงูุขู ุงููุธุงู ูุนูู ุชููุงุฆูุงู ุจุฏูู ุชุฏุฎู ุจุดุฑู! ๐ 