# 📊 Price Monitor Feature

## نظرة عامة

ميزة مراقبة الأسعار هي أداة قوية تسمح لك بمراقبة أسعار المنتجات على Amazon بشكل تلقائي ومتكرر. يمكنك إضافة مجموعة من المنتجات ومراقبة تغيرات أسعارها بدقة عالية.

## 🚀 المميزات الرئيسية

### ✅ مراقبة تلقائية
- إضافة منتجات للمراقبة باستخدام ASIN
- مراقبة الأسعار بشكل تلقائي حسب الفترة الزمنية المحددة
- تحديث الأسعار في قاعدة البيانات تلقائياً

### 📈 تتبع تغيرات الأسعار
- حساب الفرق في السعر والنسبة المئوية
- عرض تاريخ تغيرات الأسعار
- مؤشرات بصرية لارتفاع وانخفاض الأسعار

### 🚨 نظام التنبيهات
- تنبيهات عند تغير السعر بنسبة محددة
- إعداد عتبة التنبيه لكل منتج
- أنواع التنبيهات: زيادة، انخفاض، عتبة

### 🌍 دعم متعدد المناطق
- دعم Amazon مصر (amazon.eg)
- دعم Amazon السعودية (amazon.sa)
- دعم Amazon الإمارات (amazon.ae)
- دعم Amazon الولايات المتحدة (amazon.com)
- دعم Amazon ألمانيا (amazon.de)

## 🛠️ الإعداد والتشغيل

### 1. إعداد قاعدة البيانات

قم بتشغيل ملف SQL التالي لإنشاء الجداول المطلوبة:

```bash
# في Supabase SQL Editor
# انسخ محتوى ملف PRICE_MONITOR_SETUP.sql والصقه
```

### 2. تشغيل خدمة المراقبة الخلفية

```bash
# في مجلد backend
node price_monitor_service.cjs
```

### 3. إعداد متغيرات البيئة

تأكد من وجود المتغيرات التالية في ملف `.env`:

```env
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_supabase_anon_key
```

## 📱 كيفية الاستخدام

### إضافة منتج للمراقبة

1. **اذهب إلى صفحة Price Monitor**
   - انقر على "Price Monitor" في القائمة الجانبية

2. **أضف منتج جديد**
   - انقر على "Add Product"
   - أدخل ASIN المنتج (10 أحرف)
   - اختر المنطقة (مصر، السعودية، إلخ)
   - حدد فترة المراقبة (15 دقيقة إلى 24 ساعة)
   - حدد عتبة التنبيه (نسبة مئوية)
   - انقر على "Add to Monitor"

### إدارة المنتجات

#### تفعيل/إلغاء تفعيل المراقبة
- استخدم المفتاح (Switch) بجانب كل منتج
- المنتجات المفعلة فقط يتم مراقبتها

#### حذف منتج
- انقر على أيقونة الحذف (🗑️) بجانب المنتج
- سيتم حذف المنتج وكل تاريخه

#### تصدير البيانات
- انقر على "Export" لتصدير جميع البيانات إلى CSV
- يتضمن الأسعار الحالية والسابقة والتغيرات

### مراقبة الأسعار

#### عرض المنتجات
- جدول يعرض جميع المنتجات المراقبة
- السعر الحالي والسابق
- نسبة التغير مع مؤشرات بصرية
- وقت المراقبة التالية

#### تاريخ الأسعار
- انقر على "Show History" لعرض تاريخ الأسعار
- يعرض آخر 20 تحديث سعر
- مرتب حسب التاريخ

## 🔧 الإعدادات المتقدمة

### فترات المراقبة المتاحة
- **15 دقيقة**: للمنتجات عالية التقلب
- **30 دقيقة**: للمنتجات متوسطة التقلب
- **1 ساعة**: الإعداد الافتراضي
- **2 ساعة**: للمنتجات منخفضة التقلب
- **4 ساعات**: للمنتجات المستقرة
- **8 ساعات**: للمراقبة اليومية
- **24 ساعة**: للمراقبة الأسبوعية

### عتبات التنبيه
- **1-5%**: تنبيهات حساسة للتغيرات الصغيرة
- **5-10%**: تنبيهات متوسطة (الإعداد الافتراضي)
- **10-20%**: تنبيهات للتغيرات الكبيرة
- **20%+**: تنبيهات للتغيرات الجذرية

## 📊 فهم البيانات

### مؤشرات تغير السعر
- **🟢 أخضر + سهم لأسفل**: انخفاض في السعر
- **🔴 أحمر + سهم لأعلى**: ارتفاع في السعر
- **⚪ رمادي**: لا يوجد تغير

### حالة المراقبة
- **🟢 Active**: المراقبة مفعلة
- **🔴 Inactive**: المراقبة متوقفة

### وقت المراقبة التالية
- **Due now**: مستحق الآن
- **Soon**: خلال ساعة
- **Scheduled**: مجدول للمستقبل

## 🚨 نظام التنبيهات

### أنواع التنبيهات
1. **Increase**: عند ارتفاع السعر
2. **Decrease**: عند انخفاض السعر
3. **Threshold**: عند تجاوز عتبة التنبيه

### إدارة التنبيهات
- عرض التنبيهات غير المقروءة
- تمييز التنبيهات كمقروءة
- تصفية التنبيهات حسب النوع

## 🔍 استكشاف الأخطاء

### مشاكل شائعة وحلولها

#### المنتج لا يتم مراقبته
- تأكد من أن ASIN صحيح (10 أحرف)
- تحقق من أن المنتج مفعل
- تأكد من أن فترة المراقبة لم تنته بعد

#### عدم تحديث الأسعار
- تحقق من اتصال الإنترنت
- تأكد من تشغيل خدمة المراقبة الخلفية
- تحقق من صحة متغيرات البيئة

#### أخطاء في السكرابينج
- قد يكون المنتج غير متوفر
- قد تكون هناك حماية من Amazon
- جرب تغيير المنطقة

### سجلات الأخطاء
- تحقق من console في المتصفح
- راجع سجلات خدمة المراقبة الخلفية
- تحقق من سجلات Supabase

## 📈 أفضل الممارسات

### اختيار المنتجات
- اختر منتجات مستقرة نسبياً
- تجنب المنتجات التي تتغير أسعارها بشكل متكرر جداً
- ركز على المنتجات المهمة لعملك

### إعداد فترات المراقبة
- استخدم فترات قصيرة للمنتجات عالية التقلب
- استخدم فترات طويلة للمنتجات المستقرة
- لا تضع فترات قصيرة جداً لتجنب الحظر

### إدارة التنبيهات
- ضع عتبات واقعية (5-10%)
- راجع التنبيهات بانتظام
- احذف التنبيهات القديمة

## 🔒 الأمان والخصوصية

### حماية البيانات
- جميع البيانات مشفرة في قاعدة البيانات
- لا يتم مشاركة البيانات مع أطراف ثالثة
- يمكن حذف البيانات في أي وقت

### حدود الاستخدام
- احترم شروط استخدام Amazon
- لا تستخدم السكرابينج بشكل مفرط
- التزم بحدود الاستخدام العادلة

## 📞 الدعم

### الحصول على المساعدة
- راجع هذا الدليل أولاً
- تحقق من قسم استكشاف الأخطاء
- تواصل مع فريق الدعم

### الإبلاغ عن المشاكل
- وصف المشكلة بالتفصيل
- أرفق لقطات شاشة إن أمكن
- اذكر خطوات إعادة المشكلة

---

**ملاحظة**: هذه الميزة مصممة لمراقبة الأسعار بشكل قانوني وأخلاقي. يرجى احترام شروط استخدام Amazon وعدم إساءة استخدام هذه الأداة. 